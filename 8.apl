#!/usr/bin/env dyalogscript
input ← ⊃⎕NGET 'input/8.txt' 1

h ← {1++⌿(2 1 0*⍨⊂≢(⎕A,⎕D))×(1-⍨(⎕A,⎕D)⍳⍵)}
n ← 0⍨¨⍳h'999'
{n[⍺] ← ⊂⍵}/↑{(h ⍵[⍳3])((h ⍵[7+⍳3]),h ⍵[12+⍳3])}¨2↓input
lr ← 1+'R'=⊃input
I ← {⍵ /⍨ 1=36|⍵}⍸≢⍤⍴¨n
⎕ ← {(⊃⍵),(0⍕∧⌿⍵)}{c ← 0 ⋄ i ← ⍵ ⋄ c ⊣ {i ⊢← (i⊃n)[lr[1+(≢lr)|c]] ⋄ c +← 1 ⋄ ⍬}⍣{26=36|i}⍬}¨I
